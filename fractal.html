<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <script type="text/javascript" src="math.js"></script>
    <script type="text/javascript" src="complex.js"></script>
    <script type="text/javascript" src="quaternion.js"></script>
    <script type="text/javascript" src="operation.js"></script>
    <script type="text/javascript" src="fractal_dimension.js"></script>
    <title>Newton Fractals in HTML5 Canvas &amp; JavaScript</title>
    <!--
     Newton fractal generator, in HTML5 canvas and javascript.
     Link to repository: https://gitlab.eecs.umich.edu/logm/fa23/newton-method-23/newton-method
     Link to original work this is based on (Mandelbrot set visualizer): https://github.com/cslarsen/mandelbrot-js

     Copyright (C) 2023 Ryan Vig
     Copyright (C) 2012 Christian Stigen Larsen

     Licensed under the Apache License, Version 2.0 (the "License"); you may
     not use this file except in compliance with the License.  You may
     obtain a copy of the License at

         http://www.apache.org/licenses/LICENSE-2.0

     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
     implied.  See the License for the specific language governing
     permissions and limitations under the License.
     -->
    <style type="text/css">
      body {
        background-color: black;
        padding: 0px;
        margin: 0px;
        font-size: 10pt;
        text-shadow: 0px 1px 0px rgb(40, 40, 40);
      }

      a {
        color: #ccc;
        text-decoration: none;
      }
      a:hover {
        color: #ff3b03;
      }

      #bottom {
        color: #666;
      }
      #bottom a {
        color: #666;
      }
      #bottom a:hover {
        color: #ff3b03;
      }

      #canvasFractal {
        background-color: black;
        margin-right: auto;
        padding-left: 0;
        padding-right: 0;
        margin-left: auto;
        margin-right: auto;
        display: block;
      }

      #canvasControls {
        background-color: transparent;
        position: absolute;
        left: 0px;
        top: 0px;
        z-index: 5;
        padding: 0px;
        margin: 0px;
        width: 100%;
        height: 100%;
      }

      #description {
        z-index: 10;
        position: absolute;
        background-color: rgba(30, 30, 30, 0.6);
        font-family: sans-serif;
        padding: 20px;
        margin: 20px;
        border: 2px solid rgba(20, 20, 20, 0.6);
        color: #ff3b03;
        text-shadow: 0px 1px 0px rgb(40, 40, 40);
        width: 20%;

        /* Make text non-selectable */
        -moz-user-select: none;
        -khtml-user-select: none;
        -webkit-user-select: none;
        -o-user-select: none;
        user-select: none;
      }

      #description table {
        color: #ccc;
        width: 90%;
      }

      #description input {
        color: #ccc;
        outline: none;
        background-color: rgba(48, 48, 48, 0.3);
        border-width: 1px;
        border-color: #444;
        width: 65%;
      }

      #description select {
        border: #444 1px solid;
        color: #ccc;
        outline: none;
        background-color: #333;
        appearance: none;
        -webkit-appearance: none;
        font-size: 10pt;
        width: 60%;
      }

      .headerText {
        color: #666;
      }

      #description .textInput {
        text-align: right;
        background-color: transparent;
        border: #444 1px solid;
        font-size: 10pt;
        width: 50%;
      }

      hr {
        border-color: #222;
      }
    </style>
  </head>
  <body onload="focusOnSubmit();">
    <div id="description">
      <header>
        <div style="text-align: center">
          <hr />
          <h1>Newton Fractals</h1>
          <p class="headerText">In HTML5 Canvas and JavaScript</p>
          <hr />
        </div>
      </header>

      <form id="settingsForm" action="javascript:draw(getColorPicker());">
        <table>
          <tr>
            <td>Rendering time</td>
            <td><span id="renderTime">0.0</span> seconds</td>
          </tr>
          <tr>
            <td>Speed</td>
            <td>
              <span id="renderSpeed">0.00</span> pixels /
              <span id="renderSpeedUnit">second</span>
            </td>
          </tr>
          <tr>
            <td>Function</td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="function"
                value="z^3-1"
                title="input function"
              />
            </td>
          </tr>
          <tr>
            <td>Generalized iteration scalar (a+bi)</td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="scalar"
                value="1"
                title="may be any complex number (1 for 'true' Newton fractals)"
              />
            </td>
          </tr>
          <tr>
            <td title="non-zero value will switch to 'nova mode' and create nova fractals (colored by divergence, rather than convergence)">Nova fractal iteration offset (c+di)</td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="offset"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td title="will alter plane to be a 2D slice of 4D space with these 2 dimensions fixed (function itself is unchanged)">Fixed quaternion projection values (cj+dk)</td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="quaternionC"
                value="0"
                title="(fixed 'c' in a+bi+cj+dk)"
              />
            </td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="quaternionD"
                value="0"
                title="(fixed 'd' in a+bi+cj+dk)"
              />
            </td>
          </tr>
          <tr>
            <td>Max iterations</td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="steps"
                value="50"
                title="maximum iterations"
              />
            </td>
          </tr>
          <tr>
            <td>Color scheme</td>
            <td>
              <select id="colorScheme" title="scheme">
                <option value="pickColorGrayscale">Grayscale</option>
                <option value="pickColorColor">Color</option>
                <option value="pickColorBoundary">Boundary</option>
                <option value="pickColorPureBoundary" title="mostly same as 'Boundary', but does not color all nonconverging points black">Pure Boundary</option>
              </select>
            </td>
          </tr>
          <tr>
            <td>Center Point (a+bi)</td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="center"
                value="0"
                title="point image is centered at"
              />
            </td>
          </tr>
          <tr>
            <td>Width</td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="width"
                value="15"
                title="length of real axis to show (height will be scaled to appropriate aspect raatio)"
              />
            </td>
          </tr>
          <tr>
            <td>Precision (10^(-n))</td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="precision"
                value="5"
                title="convergence tolerance (flips sign when drawing nova fractals)"
              />
            </td>
          </tr>
          <tr>
            <td>Draw as square?</td>
            <td>
              <input
                class="textInput"
                size="4"
                type="checkbox"
                id="isSquare"
                title="Check this to set a 1:1 aspect ratio"
              />
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <input type="submit" id="submitButton" value="Draw" />
              &nbsp;
              <input type="reset" id="resetButton" value="Reset" />
              &nbsp;
              <input type="button" id="rerollColors" value="Reroll Colors" />
              &nbsp;
              <input type="button" id="savePNG" value="Save as PNG" />
              &nbsp;
              <input type="button" id="calcDimension" value="Compute Fractal Dimension" />
            </td>
          </tr>
          <tr>
            <td>
              Fractal dimension
            </td>
            <td>
              <input
                class="textInput"
                size="4"
                type="text"
                id="fractalDimension"
                title="Fractal dimension of current image (estimated using box counting, restrict to boundary region for best estimate)"
                readonly
              />
            </td>
          </tr>
          <tr>
            <td>Box counting precision (integer)</td>
            <td>
              <input
                class="textInput"
                size="6"
                type="text"
                id="gridScale"
                title="Number of boxes-wide to go when box counting (increase for more precise fractal dimension estimte)"
                value="100"
              />
            </td>
          </tr>
        </table>
      </form>

      <div id="bottom">
        <small>
          Inspired by Christian Stigen Larsen's Mandelbrot Set visualizer
          <br />
          &nbsp; <br />
          Shift+Space to toggle options menu view. Click + drag to zoom in, shift +click to zoom out. You can change the
          settings above and hit <i>Draw</i> to render anew.
        </small>
      </div>
    </div>

    <div id="canvasContainer">
      <canvas id="canvasFractal" width="0" height="0"> </canvas>
      <canvas id="canvasControls" width="0" height="0"> </canvas>
    </div>

    <script type="text/javascript" src="fractal.js"></script>
  </body>
</html>
